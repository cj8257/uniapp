{"version":3,"file":"login.js","sources":["pages/login/login.vue","../../Downloads/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbG9naW4vbG9naW4udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"container\">\r\n\t\t<view class=\"login-box\">\r\n\t\t\t<view class=\"title\">办公用品管理系统</view>\r\n\t\t\t<view class=\"subtitle\">账号密码登录</view>\r\n\t\t\t\r\n\t\t\t<view class=\"form-box\">\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<input class=\"input\" type=\"text\" v-model=\"form.username\" placeholder=\"请输入用户名\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"form-item\">\r\n\t\t\t\t\t<input class=\"input\" type=\"password\" v-model=\"form.password\" placeholder=\"请输入密码\" />\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"remember-box\">\r\n\t\t\t\t\t<checkbox-group @change=\"handleRememberChange\">\r\n\t\t\t\t\t\t<checkbox :checked=\"rememberPassword\" style=\"transform:scale(0.7)\"/>\r\n\t\t\t\t\t\t<text class=\"remember-text\">记住密码</text>\r\n\t\t\t\t\t</checkbox-group>\r\n\t\t\t\t\t<text class=\"forget-text\" @click=\"goToReset\">忘记密码？</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<button class=\"login-btn\" @click=\"handleLogin\" :loading=\"loading\">登录</button>\r\n\t\t\t</view>\r\n\t\t\t\r\n\t\t\t<view class=\"status-tip\" :class=\"{'error': loginStatus === 'error'}\">\r\n\t\t\t\t{{statusText}}\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tform: {\r\n\t\t\t\tusername: '',\r\n\t\t\t\tpassword: ''\r\n\t\t\t},\r\n\t\t\trememberPassword: false,\r\n\t\t\tloading: false,\r\n\t\t\tloginStatus: '', // success, error\r\n\t\t\tstatusText: ''\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tasync handleLogin() {\r\n\t\t\tif (!this.form.username || !this.form.password) {\r\n\t\t\t\tthis.loginStatus = 'error'\r\n\t\t\t\tthis.statusText = '请输入用户名和密码'\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tthis.loading = true\r\n\t\t\ttry {\r\n\t\t\t\t// TODO: 调用登录API\r\n\t\t\t\tconst res = await this.$api.user_login(this.form)\r\n\t\t\t\tconsole.log(res);\r\n\t\t\t\tif (this.rememberPassword) {\r\n\t\t\t\t\tuni.setStorageSync('savedUsername', this.form.username)\r\n\t\t\t\t\tuni.setStorageSync('savedPassword', this.form.password)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.removeStorageSync('savedUsername')\r\n\t\t\t\t\tuni.removeStorageSync('savedPassword')\r\n\t\t\t\t}\r\n\t\t\t\t// // 模拟获取用户信息\r\n\t\t\t\tconst userInfo = {\r\n\t\t\t\t\tavatar: res.data.data[0].avatar || '/static/user/默认.webp',\r\n\t\t\t\t\tnickname: res.data.data[0].username,\r\n\t\t\t\t\tdepartment: res.data.data[0].department,\r\n\t\t\t\t\trole: res.data.data[0].role,\r\n\t\t\t\t\tphone: res.data.data[0].phone,\r\n\t\t\t\t\tusername: res.data.data[0].username\r\n\t\t\t\t}\r\n\t\t\t\tuni.setStorageSync('token', 'mock-token')\r\n\t\t\t\tuni.setStorageSync('userInfo', userInfo)\r\n\t\t\t\t\r\n\t\t\t\t// 显示用户信息收集说明\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '用户信息收集说明',\r\n\t\t\t\t\tcontent: '为了给您提供更好的服务，我们需要收集您的以下信息：\\n\\n1. 头像：用于在系统中显示您的个人头像\\n2. 昵称：用于在系统中显示您的名称\\n\\n这些信息仅用于系统内部使用，我们承诺不会将您的信息用于其他用途或提供给第三方。\\n\\n您是否同意授权我们收集这些信息？',\r\n\t\t\t\t\tconfirmText: '同意',\r\n\t\t\t\t\tcancelText: '拒绝',\r\n\t\t\t\t\tsuccess: async (res) => {\r\n\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t// 用户同意后获取用户信息 \r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tconst userProfile = await uni.getUserProfile({\r\n\t\t\t\t\t\t\t\t\tdesc: '用于完善用户资料，提供个性化服务'\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t// 更新用户信息\r\n\t\t\t\t\t\t\t\tconst updatedUserInfo = {\r\n\t\t\t\t\t\t\t\t\t...userInfo,\r\n\t\t\t\t\t\t\t\t\tavatar: userProfile.userInfo.avatarUrl || userInfo.avatar,\r\n\t\t\t\t\t\t\t\t\tnickname: userProfile.userInfo.nickName || userInfo.nickname\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tuni.setStorageSync('userInfo', updatedUserInfo)\r\n\t\t\t\t\t\t\t} catch (err) {\r\n\t\t\t\t\t\t\t\tconsole.log('用户拒绝授权', err)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 无论用户是否同意，都继续跳转\r\n\t\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\t\turl: '/pages/my/my'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthis.loginStatus = 'error'\r\n\t\t\t\tthis.statusText = '登录失败，请重试'\r\n\t\t\t} finally {\r\n\t\t\t\tthis.loading = false\r\n\t\t\t}\r\n\t\t},\r\n\t\thandleRememberChange(e) {\r\n\t\t\tthis.rememberPassword = e.detail.value.length > 0\r\n\t\t},\r\n\t\tgoToReset() {\r\n\t\t\tuni.navigateTo({\r\n\t\t\t\turl: '/pages/login/reset-password'\r\n\t\t\t})\r\n\t\t}\r\n\t},\r\n\tonLoad() {\r\n\t\t// 加载保存的账号密码\r\n\t\tconst savedUsername = uni.getStorageSync('savedUsername')\r\n\t\tconst savedPassword = uni.getStorageSync('savedPassword')\r\n\t\tif (savedUsername && savedPassword) {\r\n\t\t\tthis.form.username = savedUsername\r\n\t\t\tthis.form.password = savedPassword\r\n\t\t\tthis.rememberPassword = true\r\n\t\t}\r\n\t}\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.container {\r\n\tmin-height: 100vh;\r\n\tbackground-color: #F5F5F5;\r\n\tdisplay: flex;\r\n\talign-items: center;\r\n\tjustify-content: center;\r\n\tpadding: 40rpx;\r\n\t\r\n\t.login-box {\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #FFFFFF;\r\n\t\tborder-radius: 20rpx;\r\n\t\tpadding: 60rpx 40rpx;\r\n\t\tbox-shadow: 0 4rpx 20rpx rgba(0,0,0,0.1);\r\n\t\t\r\n\t\t.title {\r\n\t\t\tfont-size: 40rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t\tcolor: #333333;\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.subtitle {\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666666;\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-bottom: 60rpx;\r\n\t\t}\r\n\t\t\r\n\t\t.form-box {\r\n\t\t\tmargin-bottom: 40rpx;\r\n\t\t\t\r\n\t\t\t.form-item {\r\n\t\t\t\tmargin-bottom: 30rpx;\r\n\t\t\t\t\r\n\t\t\t\t.input {\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\theight: 80rpx;\r\n\t\t\t\t\tbackground: #F8F8F8;\r\n\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t\tpadding: 0 30rpx;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.remember-box {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tjustify-content: space-between;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tmargin-bottom: 40rpx;\r\n\t\t\t\t\r\n\t\t\t\t.remember-text {\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t\tmargin-left: 4rpx;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t.forget-text {\r\n\t\t\t\t\tfont-size: 26rpx;\r\n\t\t\t\t\tcolor: #2d8cf0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t.login-btn {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tbackground: #2d8cf0;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t.status-tip {\r\n\t\t\ttext-align: center;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tcolor: #666666;\r\n\t\t\t\r\n\t\t\t&.error {\r\n\t\t\t\tcolor: #FF4D4F;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n</style> ","import MiniProgramPage from 'C:/Users/admin/Desktop/办公管理/pages/login/login.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","res"],"mappings":";;AA+BA,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,MAAM;AAAA,QACL,UAAU;AAAA,QACV,UAAU;AAAA,MACV;AAAA,MACD,kBAAkB;AAAA,MAClB,SAAS;AAAA,MACT,aAAa;AAAA;AAAA,MACb,YAAY;AAAA,IACb;AAAA,EACA;AAAA,EACD,SAAS;AAAA,IACR,MAAM,cAAc;AACnB,UAAI,CAAC,KAAK,KAAK,YAAY,CAAC,KAAK,KAAK,UAAU;AAC/C,aAAK,cAAc;AACnB,aAAK,aAAa;AAClB;AAAA,MACD;AACA,WAAK,UAAU;AACf,UAAI;AAEH,cAAM,MAAM,MAAM,KAAK,KAAK,WAAW,KAAK,IAAI;AAChDA,sBAAAA,MAAA,MAAA,OAAA,+BAAY,GAAG;AACf,YAAI,KAAK,kBAAkB;AAC1BA,wBAAAA,MAAI,eAAe,iBAAiB,KAAK,KAAK,QAAQ;AACtDA,wBAAAA,MAAI,eAAe,iBAAiB,KAAK,KAAK,QAAQ;AAAA,eAChD;AACNA,wBAAG,MAAC,kBAAkB,eAAe;AACrCA,wBAAG,MAAC,kBAAkB,eAAe;AAAA,QACtC;AAEA,cAAM,WAAW;AAAA,UAChB,QAAQ,IAAI,KAAK,KAAK,CAAC,EAAE,UAAU;AAAA,UACnC,UAAU,IAAI,KAAK,KAAK,CAAC,EAAE;AAAA,UAC3B,YAAY,IAAI,KAAK,KAAK,CAAC,EAAE;AAAA,UAC7B,MAAM,IAAI,KAAK,KAAK,CAAC,EAAE;AAAA,UACvB,OAAO,IAAI,KAAK,KAAK,CAAC,EAAE;AAAA,UACxB,UAAU,IAAI,KAAK,KAAK,CAAC,EAAE;AAAA,QAC5B;AACAA,4BAAI,eAAe,SAAS,YAAY;AACxCA,4BAAI,eAAe,YAAY,QAAQ;AAGvCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,SAAS;AAAA,UACT,aAAa;AAAA,UACb,YAAY;AAAA,UACZ,SAAS,OAAOC,SAAQ;AACvB,gBAAIA,KAAI,SAAS;AAEhB,kBAAI;AACH,sBAAM,cAAc,MAAMD,cAAG,MAAC,eAAe;AAAA,kBAC5C,MAAM;AAAA,iBACN;AAED,sBAAM,kBAAkB;AAAA,kBACvB,GAAG;AAAA,kBACH,QAAQ,YAAY,SAAS,aAAa,SAAS;AAAA,kBACnD,UAAU,YAAY,SAAS,YAAY,SAAS;AAAA,gBACrD;AACAA,oCAAI,eAAe,YAAY,eAAe;AAAA,cAC7C,SAAO,KAAK;AACbA,8BAAAA,MAAY,MAAA,OAAA,+BAAA,UAAU,GAAG;AAAA,cAC1B;AAAA,YACD;AAEAA,0BAAAA,MAAI,UAAU;AAAA,cACb,KAAK;AAAA,aACL;AAAA,UACF;AAAA,SACA;AAAA,MAEA,SAAO,OAAO;AACf,aAAK,cAAc;AACnB,aAAK,aAAa;AAAA,MACnB,UAAU;AACT,aAAK,UAAU;AAAA,MAChB;AAAA,IACA;AAAA,IACD,qBAAqB,GAAG;AACvB,WAAK,mBAAmB,EAAE,OAAO,MAAM,SAAS;AAAA,IAChD;AAAA,IACD,YAAY;AACXA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,OACL;AAAA,IACF;AAAA,EACA;AAAA,EACD,SAAS;AAER,UAAM,gBAAgBA,cAAAA,MAAI,eAAe,eAAe;AACxD,UAAM,gBAAgBA,cAAAA,MAAI,eAAe,eAAe;AACxD,QAAI,iBAAiB,eAAe;AACnC,WAAK,KAAK,WAAW;AACrB,WAAK,KAAK,WAAW;AACrB,WAAK,mBAAmB;AAAA,IACzB;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;ACnIA,GAAG,WAAW,eAAe;"}